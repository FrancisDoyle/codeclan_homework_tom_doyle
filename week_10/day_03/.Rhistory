library(car)
library(tidyverse)
library(modelr)
library(leaps)
house <- read_csv("data/kc_house_data.csv")
glimpse(house)
#houses_tidy <- house %>%
#mutate(renovated = ifelse(yr_renovated > 0, TRUE, FALSE)) %>%
#select(-date, -id, -sqft_living15, -sqft_lot15, -zipcode, -yr_renovated)
#houses_tidy <- houses_tidy %>%
#fastDummies::dummy_cols(select_columns = c("view", "condition", "grade"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
houses_tidy <- house %>%
select(-c("id", "date", "sqft_living15", "sqft_lot15", "zipcode")) %>%
mutate(waterfront = as.logical(waterfront)) %>%
mutate(renovated = yr_renovated != 0) %>%
select(-"yr_renovated") %>%
mutate(view = as_factor(view)) %>%
mutate(condition = as_factor(condition)) %>%
mutate(grade = as_factor(grade))
alias(lm(price~., data = houses_tidy))
houses_tidy <- houses_tidy %>%
select(-sqft_living)
alias(lm(price~., data = houses_tidy))
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
mod2 <- lm(price~ bathrooms + view + grade + lat, data = houses_tidy)
summary(mod2)
autoplot(mod2)
summary(mod2)
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
sum_predictors$which[4,]
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = NULL, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
sum_predictors$which[4,]
house <- read_csv("data/kc_house_data.csv")
glimpse(house)
#houses_tidy <- house %>%
#mutate(renovated = ifelse(yr_renovated > 0, TRUE, FALSE)) %>%
#select(-date, -id, -sqft_living15, -sqft_lot15, -zipcode, -yr_renovated)
#houses_tidy <- houses_tidy %>%
#fastDummies::dummy_cols(select_columns = c("view", "condition", "grade"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
houses_tidy <- house %>%
select(-c("id", "date", "sqft_living15", "sqft_lot15", "zipcode")) %>%
mutate(waterfront = as.logical(waterfront)) %>%
mutate(renovated = yr_renovated != 0) %>%
select(-"yr_renovated") %>%
mutate(view = as_factor(view)) %>%
mutate(condition = as_factor(condition)) %>%
mutate(grade = as_factor(grade))
houses_tidy <- houses_tidy %>%
select(-sqft_living)
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = NULL, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
View(houses_tidy)
summary(mod3)
mod3 <- lm(price~ waterfront + sqfr_above + sqft_basement + lat, data = houses_tidy)
mod3 <- lm(price~ waterfront + sqfr_above + sqft_basement + lat, data = houses_tidy)
mod3 <- lm(price~ waterfront + sqft_above + sqft_basement + lat, data = houses_tidy)
summary(mod3)
summary(mod2)
mod2 <- lm(price~ bathrooms + view + grade + lat, data = houses_tidy)
mod3 <- lm(price~ waterfront + sqft_above + sqft_basement + lat, data = houses_tidy)
summary(mod2)
summary(mod3)
summary(mod2)
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
mod3 <- lm(price~ bathrooms + sqft_above + sqft_basement + lat, data = houses_tidy)
summary(mod3)
mod2 <- lm(price~ waterfront + view + grade + lat, data = houses_tidy)
summary(mod2)
mod2 <- lm(price~ bathroom + view + grade + lat, data = houses_tidy)
mod2 <- lm(price~ bathrooms + view + grade + lat, data = houses_tidy)
summary(mod2)
mod2 <- lm(price~ bathrooms + view + grade + sqft_above, data = houses_tidy)
summary(mod2)
mod2 <- lm(price~ bathrooms + view + grade + sqft_above, data = houses_tidy)
summary(mod2)
mod2 <- lm(price~ bathrooms + view + grade + lat, data = houses_tidy)
summary(mod2)
library(car)
library(tidyverse)
library(modelr)
library(leaps)
house <- read_csv("data/kc_house_data.csv")
glimpse(house)
#houses_tidy <- house %>%
#mutate(renovated = ifelse(yr_renovated > 0, TRUE, FALSE)) %>%
#select(-date, -id, -sqft_living15, -sqft_lot15, -zipcode, -yr_renovated)
#houses_tidy <- houses_tidy %>%
#fastDummies::dummy_cols(select_columns = c("view", "condition", "grade"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
houses_tidy <- house %>%
select(-c("id", "date", "sqft_living15", "sqft_lot15", "zipcode")) %>%
mutate(waterfront = as.logical(waterfront)) %>%
mutate(renovated = yr_renovated != 0) %>%
select(-"yr_renovated") %>%
mutate(view = as_factor(view)) %>%
mutate(condition = as_factor(condition)) %>%
mutate(grade = as_factor(grade))
alias(lm(price~., data = houses_tidy))
houses_tidy <- houses_tidy %>%
select(-sqft_living)
alias(lm(price~., data = houses_tidy))
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$adjr2)
sum_predictors$which[4,]
mod2 <- lm(price~ bathrooms + view + grade + lat, data = houses_tidy)
summary(mod2)
autoplot(mod2)
library(ggfortify)
autoplot(mod2)
autoplot(mod2)
summary(mod2)
mod1 <- lm(price~., data = houses_tidy)
summary(mod1)
predictors <- regsubsets(price~., data = houses_tidy, nbest = 1, nvmax = 4, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
which.max(sum_predictors$rsq)
sum_predictors$which[4,]
sum_predictors$which[4,]
mod3 <- lm(price~ sqft_above + waterfront + sqft_basement + lat, data = houses_tidy)
summary(mod3)
summary(mod2)
