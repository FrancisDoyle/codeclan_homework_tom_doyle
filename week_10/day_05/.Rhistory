library(tidyverse)
red <- read_csv("data/wine_quality_red.csv")
white <- read_csv("data/wine_quality_white.csv")
skimr::skim(red)
View(red)
View(white)
View(red)
view(red)
View(red)
red %>%
select(-id,-region) %>%
mutate(quality = as.factor(quality))
red %>%
select(-wine_id,-region) %>%
mutate(quality = as.factor(quality))
# tidying before doing correlation analysis to help with predictor selection
# checked for categoric and was unsure of ph but believe it continous so only
#change the quality to a factor
red_clean <- red %>%
select(-wine_id,-region) %>%
mutate(quality = as.factor(quality))
skimr::skim(red)
cor(red_clean)
cor(red)
ggpairs(red_clean)
library(ggplot)
library(tidyverse)
library(ggplot2)
ggpairs(red_clean)
library(GGally)
ggpairs(red_clean)
library(corrplot)
red_clean %>%
ggpairs(aes(colour = type, alpha = 0.5))
red %>%
ggpairs(aes(colour = type, alpha = 0.5))
red %>%
ggpairs()
# tidying before checkign for correlations wiht gg pairs
red_clean <- red %>%
select(-wine_id,-region)
library(tidyverse)
library(ggplot2)
library(GGally)
red <- read_csv("data/wine_quality_red.csv")
white <- read_csv("data/wine_quality_white.csv")
skimr::skim(red)
skimr::skim(white)
view(red)
view(white)
# tidying before checkign for correlations wiht gg pairs
red_clean <- red %>%
select(-wine_id,-region)
red %>%
ggpairs()
red_clean%>%
ggpairs()
red_clean%>%
cor()
red_clean%>%
rcor()
library(tidyverse)
library(ggplot2)
library(GGally)
library(corrplot)
# tidying before checkign for correlations wiht gg pairs
red_clean <- red %>%
select(-wine_id,-region)
red_clean%>%
ggpairs()
red_clean%>%
ggpairs(lower = cor)
red_clean%>%
ggpairs(lower = "cor")
red_clean%>%
ggpairs()
View(red_clean)
library(psych)
install.packages("psych")
library(tidyverse)
library(ggplot2)
library(GGally)
library(psych)
cor.plot(red_clean)
cor.plot(red_clean, min.length = 3))
cor.plot(red_clean, min.length = 3)
cor.plot(red_clean, min.length = 3, stars = TRUE)
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid, data = red_clean )
mod2 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid + total_sulfur_dioxide, data = red_clean )
summary(mod1)
summary(mod2)
summary(mod1)
summary(mod2)
mod3 <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide, data = red_clean )
summary(mod3)
mod2 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid + total_sulfur_dioxide, data = red_clean )
summary(mod2)
summary(mod3)
mod1 <- lm(quality ~ ., data = red_clean )
#initial thoughts
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid, data = red_clean )
mod2 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid + total_sulfur_dioxide, data = red_clean )
summary(mod1)
summary(mod2)
#goign to swap citric with total sulfur dioxide as it was more significant
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide, data = red_clean )
summary(mod3)
mod3 <- lm(quality ~ ., data = red_clean )
summary(mod3)
summary(mod3)
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide + chlorides, data = red_clean )
#initial thoughts
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid, data = red_clean )
mod2 <- lm(quality ~ alcohol + volatile_acidity + sulphates + citric_acid + total_sulfur_dioxide, data = red_clean )
summary(mod1)
summary(mod2)
#goign to swap citric with total sulfur dioxide as it was more significant
mod1 <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide, data = red_clean )
summary(mod3)
mod3 <- lm(quality ~ ., data = red_clean )
summary(mod3)
#can see va,chlorides,tsd,sulphates,alc are most sig will see the effect ph has
mod_final <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide + chlorides, data = red_clean )
summary(mod_final)
mod_final <- lm(quality ~ alcohol + volatile_acidity + sulphates + total_sulfur_dioxide + chlorides + p_h, data = red_clean )
summary(mod_final)
library(leaps)
leap1 <- lm(quality~., data = red_clean)
predictors <- regsubsets(quality~., data = red_clean, nbest = 1, nvmax = NULL, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
as.data.frame(sum_predictors$outmat)
sum_predictors <- summary(predictors)
predictors <- regsubsets(quality~., data = red_clean, nbest = 1, nvmax = NULL, force.in = NULL, force.out = NULL, method = "exhaustive")
sum_predictors <- summary(predictors)
View(predictors)
which.max(sum_predictors$adjr2)
sum_predictors$which[8,]
leapmod <- lm(quality~ volatile_acidity + citric_acid + chlorides + free_sulfr_dioxide + total_sulfur_dioxide + p_h + sulphates + alcohol)
leapmod <- lm(quality~ volatile_acidity + citric_acid + chlorides + free_sulfr_dioxide + total_sulfur_dioxide + p_h + sulphates + alcohol, data=red_clean)
leapmod <- lm(quality~ volatile_acidity + citric_acid + chlorides + free_sulfur_dioxide + total_sulfur_dioxide + p_h + sulphates + alcohol, data=red_clean)
summary(leapmod)
summary(mod_final)
