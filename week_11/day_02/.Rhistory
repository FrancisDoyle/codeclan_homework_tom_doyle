library(rpart)
library(rpart.plot)
library(tidyverse)
library(tidyverse)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(survived %in% c(0,1)) %>%
# Convert to factor level
mutate(sex = as.factor(sex),
age_status = as.factor(if_else(age <= 16, "child", "adult")),
class = factor(pclass, levels = c(3,2,1), labels = c("Lower", "Middle", "Upper")),
survived_flag = factor(survived, levels = c(0,1), labels = c("No", "Yes")),
port_embarkation = as.factor(embarked)) %>%
select(sex, age_status, class, port_embarkation, sib_sp, parch, survived_flag) %>%
na.omit()
library(GGally)
ggpairs(titanic_clean)
View(titanic_clean)
library(psych)
cor.plot(titanic_clean)
ggpairs(titanic_clean)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data*0.2)
titanic_test  <- slice(clean_thrones, test_index)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data*0.2)
titanic_test  <- slice(titanic_clean, test_index)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_train %>%
janitor::tabyl(survived_flag)
titanic_part <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = 'class'
)
rpart.plot(titanic_part,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 4)
library(modelr)
titanic_test_pred <- titanic_test %>%
add_predictions(titanic_part, type = 'class')
titanic_test_pred %>%
select(sex, class, sib_sp, age_status, survived_flag, pred)
library(yardstick)
conf_mat <- titanic_test_pred %>%
conf_mat(truth = survived_flag_flag, estimate = pred)
conf_mat <- titanic_test_pred %>%
conf_mat(truth = survived_flag, estimate = pred)
conf_mat
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
titanic_part <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = 'class'
)
rpart.plot(titanic_part,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 2)
library(rpart)
library(rpart.plot)
library(tidyverse)
library(GGally)
library(modelr)
library(yardstick)
titanic_set <- read_csv('data/titanic_decision_tree_data.csv')
shuffle_index <- sample(1:nrow(titanic_set))
titanic_set <- titanic_set[shuffle_index, ]
titanic_clean <- titanic_set %>%
filter(survived %in% c(0,1)) %>%
# Convert to factor level
mutate(sex = as.factor(sex),
age_status = as.factor(if_else(age <= 16, "child", "adult")),
class = factor(pclass, levels = c(3,2,1), labels = c("Lower", "Middle", "Upper")),
survived_flag = factor(survived, levels = c(0,1), labels = c("No", "Yes")),
port_embarkation = as.factor(embarked)) %>%
select(sex, age_status, class, port_embarkation, sib_sp, parch, survived_flag) %>%
na.omit()
ggpairs(titanic_clean)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data*0.2)
titanic_test  <- slice(titanic_clean, test_index)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_train %>%
janitor::tabyl(survived_flag)
titanic_part <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = 'class'
)
rpart.plot(titanic_part,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 2)
titanic_test_pred <- titanic_test %>%
add_predictions(titanic_part, type = 'class')
titanic_test_pred %>%
select(sex, class, sib_sp, age_status, survived_flag, pred)
conf_mat <- titanic_test_pred %>%
conf_mat(truth = survived_flag, estimate = pred)
conf_mat
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
ggpairs(titanic_clean)
n_data <- nrow(titanic_clean)
test_index <- sample(1:n_data, size = n_data*0.2)
titanic_test  <- slice(titanic_clean, test_index)
titanic_train <- slice(titanic_clean, -test_index)
titanic_test %>%
janitor::tabyl(survived_flag)
titanic_train %>%
janitor::tabyl(survived_flag)
titanic_part <- rpart(
formula = survived_flag ~ .,
data = titanic_train,
method = 'class'
)
rpart.plot(titanic_part,
yesno = 2,
fallen.leaves = TRUE,
faclen = 6,
digits = 2)
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
specificity(truth = survived_flag, estimate = pred)
titanic_test_pred %>%
sensitivity(truth = survived_flag, estimate = pred)
